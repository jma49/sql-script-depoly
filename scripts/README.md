# SQL è„šæœ¬éƒ¨ç½²ç³»ç»Ÿ - Scripts ç›®å½•

è¿™ä¸ªç›®å½•åŒ…å«äº† SQL è„šæœ¬éƒ¨ç½²ç³»ç»Ÿçš„æ‰€æœ‰è¿ç»´å’Œç®¡ç†è„šæœ¬ã€‚

## ğŸ“ ç›®å½•ç»“æ„

### ğŸš€ æ ¸å¿ƒæ‰§è¡Œè„šæœ¬

- `run-sql.ts` - å•ä¸ª SQL è„šæœ¬æ‰§è¡Œå™¨
- `run-all-scripts.ts` - æ‰¹é‡è„šæœ¬æ‰§è¡Œå™¨
- `types.ts` - å…¬å…±ç±»å‹å®šä¹‰

### ğŸ§¹ ç»´æŠ¤è„šæœ¬ (`maintenance/`)

- `optimize-database-indexes.ts` - æ•°æ®åº“ç´¢å¼•ä¼˜åŒ–å’Œæ€§èƒ½ç›‘æ§

### ğŸ”’ å®‰å…¨å’Œæ€§èƒ½ (`security-and-performance/`)

- `deploy-enhanced-security-lite.ts` - å®‰å…¨å¢å¼ºå’Œæ€§èƒ½ä¼˜åŒ–éƒ¨ç½²

### ğŸ’¾ ç¼“å­˜ç®¡ç†

- `manage-cache.ts` - Redis ç¼“å­˜ç®¡ç†å·¥å…·

### ğŸ”§ æœåŠ¡ç»„ä»¶ (`services/`)

- `mongo-service.ts` - MongoDB æœåŠ¡ç®¡ç†
- `slack-service.ts` - Slack é€šçŸ¥æœåŠ¡

### âš™ï¸ æ ¸å¿ƒç»„ä»¶ (`core/`)

- `sql-executor.ts` - SQL æ‰§è¡Œæ ¸å¿ƒå¼•æ“

## ğŸ¯ å¸¸ç”¨æ“ä½œ

### æ•°æ®åº“ä¼˜åŒ–

```bash
# å®Œæ•´æ•°æ®åº“ä¼˜åŒ–
npm run optimize:db

# ä»…ç”Ÿæˆæ€§èƒ½æŠ¥å‘Š
npm run optimize:db:report

# é¢„è§ˆä¼˜åŒ–æ“ä½œ
npm run optimize:db:dry-run
```

### å®‰å…¨éƒ¨ç½²

```bash
# å®Œæ•´å®‰å…¨å’Œæ€§èƒ½éƒ¨ç½²
npm run security:deploy

# ä»…éƒ¨ç½²SQLå®‰å…¨å¢å¼º
npm run security:deploy-sql-only

# ä»…éƒ¨ç½²è¿æ¥æ± ä¼˜åŒ–
npm run security:deploy-pool-only
```

### ç¼“å­˜ç®¡ç†

```bash
# æŸ¥çœ‹ç¼“å­˜å¥åº·çŠ¶æ€
npm run cache:health

# æŸ¥çœ‹ç¼“å­˜ç»Ÿè®¡
npm run cache:stats

# æ¸…é™¤æ‰€æœ‰ç¼“å­˜
npm run cache:clear

# ç›‘æ§ç¼“å­˜æ€§èƒ½
npm run cache:monitor
```

### SQL è„šæœ¬æ‰§è¡Œ

```bash
# æ‰§è¡Œæ‰€æœ‰è„šæœ¬
npm run sql:run-all

# æ‰§è¡Œå·²å¯ç”¨çš„è„šæœ¬
npm run sql:run-enabled

# æ‰§è¡Œå®šæ—¶è„šæœ¬
npm run sql:run-scheduled

# æ‰§è¡Œç‰¹å®šè„šæœ¬
npm run sql:run <script-name>
```

## âœ¨ ä¼˜åŒ–åŠŸèƒ½çŠ¶æ€

### âœ… å·²å®Œæˆçš„ä¼˜åŒ–

- **æ•°æ®åº“ç´¢å¼•ä¼˜åŒ–** - MongoDB å’Œ PostgreSQL ç´¢å¼•å·²ä¼˜åŒ–
- **SQL å®‰å…¨å¢å¼º** - å‚æ•°åŒ–æŸ¥è¯¢ã€æ³¨å…¥é˜²æŠ¤å·²éƒ¨ç½²
- **è¿æ¥æ± ä¼˜åŒ–** - æ™ºèƒ½è¿æ¥ç®¡ç†å’Œæ€§èƒ½ç›‘æ§å·²å¯ç”¨
- **ç¼“å­˜æœºåˆ¶** - Redis ç¼“å­˜ç­–ç•¥å’Œ Check History API ç¼“å­˜å·²å®ç°
- **æŸ¥è¯¢ä¼˜åŒ–** - Check History API èšåˆæŸ¥è¯¢å·²ä¼˜åŒ–

### ğŸ“Š æ€§èƒ½æå‡æˆæœ

- **Check History API**: 50-90%æ€§èƒ½æå‡
- **æ•°æ®åº“æŸ¥è¯¢**: å¹³å‡å“åº”æ—¶é—´é™è‡³ 200ms ä»¥ä¸‹
- **ç¼“å­˜å‘½ä¸­**: 95%+çš„ç¼“å­˜å‘½ä¸­ç‡
- **è¿æ¥æ± **: QPS è¾¾åˆ° 99+ï¼Œè¿æ¥åˆ©ç”¨ç‡ä¼˜åŒ–

## ğŸ”§ ç»´æŠ¤å»ºè®®

1. **å®šæœŸæ€§èƒ½æ£€æŸ¥**

   ```bash
   npm run optimize:db:report
   npm run cache:stats
   ```

2. **ç›‘æ§ç³»ç»Ÿå¥åº·**

   ```bash
   npm run cache:health
   npm run redis:status
   ```

3. **å®‰å…¨æ£€æŸ¥**
   ```bash
   npm run security:deploy -- --no-tests
   ```

## ğŸ“ˆ ç³»ç»ŸçŠ¶æ€

- **æ€»è„šæœ¬æ•°**: 10 ä¸ªæ ¸å¿ƒè„šæœ¬
- **ä»£ç é‡**: ~77KB
- **åŠŸèƒ½è¦†ç›–**: æ‰§è¡Œã€ç¼“å­˜ã€å®‰å…¨ã€ç›‘æ§ã€ç»´æŠ¤
- **ä¼˜åŒ–çŠ¶æ€**: ğŸŸ¢ å·²å®Œæˆå…¨é¢ä¼˜åŒ–

## ğŸš¨ æ³¨æ„äº‹é¡¹

1. ç”Ÿäº§ç¯å¢ƒæ‰§è¡Œå‰è¯·å…ˆåœ¨æµ‹è¯•ç¯å¢ƒéªŒè¯
2. å¤§å‹æ“ä½œå»ºè®®åœ¨ä½å³°æœŸæ‰§è¡Œ
3. å®šæœŸå¤‡ä»½é‡è¦é…ç½®å’Œæ•°æ®
4. ç›‘æ§ç³»ç»Ÿèµ„æºä½¿ç”¨æƒ…å†µ
